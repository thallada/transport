!function(t){function o(o){for(var e,r,a=o[0],l=o[1],c=o[2],d=0,p=[];d<a.length;d++)r=a[d],i[r]&&p.push(i[r][0]),i[r]=0;for(e in l)Object.prototype.hasOwnProperty.call(l,e)&&(t[e]=l[e]);for(h&&h(o);p.length;)p.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var t,o=0;o<s.length;o++){for(var n=s[o],e=!0,a=1;a<n.length;a++){var l=n[a];0!==i[l]&&(e=!1)}e&&(s.splice(o--,1),t=r(r.s=n[0]))}return t}var e={},i={1:0},s=[];function r(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,o,n){r.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(o,"a",o),o},r.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},r.p="";var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=o,a=a.slice();for(var c=0;c<a.length;c++)o(a[c]);var h=l;s.push([110,0]),n()}({107:function(t,o,n){t.exports=n.p+"726c2296b05703758a8f65fd9097f683.png"},110:function(t,o,n){"use strict";n.r(o);var e=n(109),i=n(8),s=n(108),r=n(12);class a{constructor(t,o){this.station=t,this.line=o}}const l=(t,o)=>Math.floor(Math.random()*(o-(t+1)))+t,c=(t,o)=>{const n=o.reduce((t,o)=>t+o,0),e=l(0,n);let i=0;for(let n=0;n<o.length;n+=1)if(e<(i+=o[n]))return t[n]},h=()=>new i.Point(l(0,window.innerWidth),l(0,window.innerHeight)),d=(t,o)=>Math.abs(t.x-o.x)<1&&Math.abs(t.y-o.y)<1,p=(t,o)=>{const n=t.x-o.x,e=t.y-o.y;return Math.sqrt(n*n+e*e)},u=(t,o,n,e,i)=>(t-o)*(i-e)/(n-o)+e;var f,g;(g=f||(f={}))[g.North=0]="North",g[g.Northeast=1]="Northeast",g[g.East=2]="East",g[g.Southeast=3]="Southeast",g[g.South=4]="South",g[g.Southwest=5]="Southwest",g[g.West=6]="West",g[g.Northwest=7]="Northwest";const w=(t,o)=>{const n=((t,o)=>180+((t,o)=>Math.atan2(-(o.x-t.x),o.y-t.y))(t,o)*(180/Math.PI))(t,o);let e=null;if(n>=337.5||n<22.5)e=f.North;else if(n>=22.5&&n<67.5)e=f.Northeast;else if(n>=67.5&&n<112.5)e=f.East;else if(n>=112.5&&n<157.5)e=f.Southeast;else if(n>=157.5&&n<202.5)e=f.South;else if(n>=202.5&&n<247.5)e=f.Southwest;else if(n>=247.5&&n<292.5)e=f.West;else{if(!(n>=292.5&&n<337.5))throw Error("Angle between points is not a valid degree");e=f.Northwest}return e};let x=0;class y{static largestStation(t){let o=null;for(const n of t)(null===o||n.population>o.population)&&(o=n);return o}static stationsWithinRadius(t,o,n){return t.filter(t=>p(o,t.location)<=n)}static stationsInDirection(t,o,n){return t.filter(t=>w(o,t.location)===n)}static closestStation(t,o){return t.reduce((t,n)=>p(o,t.location)<p(o,n.location)?t:n)}static randomCloseLargeStation(t,o,n){const e=y.stationsWithinRadius(t,o,n),i=e.map(t=>t.population);return c(e,i)}static isPointDistant(t,o,n){for(const e of o)if(p(t,e.location)<n)return!1;return!0}static randomDistantPoint(t,o){let n=100;for(;n>0;){const e=h();if(y.isPointDistant(e,t,o))return e;n-=1}return null}constructor(t,o,n,e){this.location=t,this.population=o,this.color=n,this.connections=e||[],x+=1,this.id=x,this.textStyle={fill:"#FFA500",fontFamily:"monospace",fontSize:"12px"},this.renderLabel()}renderLabel(){this.label=new PIXI.Text(`${this.id}`,this.textStyle)}}const m=Math.floor(Math.sqrt(Math.pow(window.innerWidth,2)+Math.pow(window.innerHeight,2))/8);class b{constructor(t,o){this.name=t,this.color=o}connectStations(t,o,n,e){n.push(t);const i=o.filter(o=>o!==t),s=y.stationsWithinRadius(i,t.location,m);for(let o=0;o<e&&!(s.length<1);o+=1){const o=y.largestStation(s);t.connections.push(new a(o,this)),s.splice(s.indexOf(o),1)}for(const i of t.connections)-1===n.indexOf(i.station)&&this.connectStations(i.station,o,n,e)}}let S=0;class v{constructor(t,o,n,e,i,s){this.location=t,this.speed=o,this.origin=e,this.destination=i,this.passengers=n,this.color=s,this.sprite=new PIXI.Sprite(PIXI.loader.resources.nodeImg.texture),this.sprite.visible=!1,S+=1,this.id=S,this.textStyle={fill:"#AEAEAE",fontFamily:"monospace",fontSize:"12px"},this.renderLabel()}boardPassengers(){this.location,this.origin.location}renderLabel(){this.label=new PIXI.Text(`${this.id}`,this.textStyle)}}var M=n(107);n(239);const P=t=>{const o=[];for(let n=0;n<t;n+=1)o.push(new y(y.randomDistantPoint(o,30),l(300,2e3),r.random()));return o},I=(t,o)=>{const n=[];for(let e=0;e<t;e+=1){let t=r.random();for(;t.isDark();)t=r.random();const i=o.filter(t=>0===t.connections.length);let s;s=i.length>0?y.largestStation(i):o[l(0,o.length-1)];const a=new b(`line-${e}`,r.random()),c=o.slice(0);a.connectStations(s,c,[],5),n.push(a)}return n};i.loader.add("nodeImg",M).load(()=>{const t=new i.Application({antialias:!0,height:window.innerHeight,width:window.innerWidth}),o=new e({screenHeight:window.innerHeight,screenWidth:window.innerWidth,worldHeight:1e3,worldWidth:1e3}),n=new s;n.showPanel(0),document.body.appendChild(n.dom);const a=new i.ticker.Ticker,h=new i.Graphics;let f=[],g=[],w=[];for(;0===w.length;)f=P(30),g=I(4,f),w=f.filter(t=>t.connections.length>0);const x=((t,o)=>{const n=[],e=f.filter(t=>t.connections.length>0);for(let t=0;t<50;t+=1){const t=e[Math.floor(Math.random()*e.length)];n.push(new v(new i.Point(t.location.x,t.location.y),0,0,t,void 0,r("grey")))}return n})();a.stop(),a.add(t=>{n.begin(),((t,o)=>{for(const o of t){if(0===o.origin.connections.length)continue;if(void 0===o.destination){const t=o.origin.connections.map(t=>t.station),n=t.map(t=>t.population);o.destination=c(t,n);const e=l(0,Math.min(50-o.passengers,o.origin.population));0===o.passengers?o.color=o.origin.color:o.color=r.mix(o.color,o.origin.color,Math.round(e/o.passengers*100)),o.passengers+=e,o.origin.population-=e}if(d(o.location,o.destination.location)){o.speed=0,o.destination.color=r.mix(o.destination.color,o.origin.color,Math.round(o.passengers/o.destination.population*100));const t=l(0,o.passengers);o.destination.population+=t,o.passengers-=t,o.origin=o.destination,o.destination=void 0;continue}const t=p(o.location,o.destination.location);o.speed/.025>=t/o.speed-3&&.025!==o.speed?o.speed-=.025:o.speed<10&&(o.speed+=.025);const n=o.speed/t;o.location.x+=(o.destination.location.x-o.location.x)*n,o.location.y+=(o.destination.location.y-o.location.y)*n}})(x),h.clear(),h.lineStyle(1,16753920,1),((t,o)=>{for(const n of t){const t=n.population/150;o.beginFill(parseInt(n.color.toHex(),16),.5),o.drawCircle(n.location.x,n.location.y,t),o.endFill(),n.label.x=n.location.x+t+1,n.label.y=n.location.y+t+1}})(f,h),h.lineStyle(1,11447982,1),((t,o)=>{for(const o of t){const t=u(o.passengers,0,50,1,5)/100;o.sprite.visible=!0,o.sprite.x=o.location.x,o.sprite.y=o.location.y,o.sprite.scale.x=t,o.sprite.scale.y=t,o.sprite.tint=parseInt(o.color.toHex(),16),o.label.x=o.location.x+t+1,o.label.y=o.location.y+t+1}})(x),((t,o)=>{for(const n of t)for(const t of n.connections){let e=!1;for(const o of t.station.connections)o.station===n&&(e=!0);o.lineStyle(e?2:1,parseInt(t.line.color.toHex(),16),1),o.moveTo(n.location.x,n.location.y),o.lineTo(t.station.location.x,t.station.location.y)}})(f,h),n.end()}),a.start(),o.addChild(h);for(const t of x)o.addChild(t.sprite);for(const t of x)o.addChild(t.label);for(const t of f)o.addChild(t.label);document.body.appendChild(t.view),t.stage.addChild(o),o.drag().pinch().wheel().clampZoom({maxHeight:4e3,maxWidth:4e3,minHeight:100,minWidth:100}).decelerate(),window.addEventListener("resize",()=>{t.renderer.resize(window.innerWidth,window.innerHeight)})})},116:function(t,o){},239:function(t,o){}});
//# sourceMappingURL=main.min.js.map